let xReply=0,xReffReply=0;class EditModal{constructor(){this.html='<form method="post"><fieldset>   <div class="col p-3 small-text">       <div class="row my-3">           <input name="collection-title" placeholder="Collection Title" required>       </div>       <div class="row my-3">           <textarea rows="2" name="short-description" required>Short description (Optional)</textarea>       </div>       <div class="row">           <button id="confirm-changes" class="py-1 px-3 m-0 my-1 fs-16">Save Changes</button>       </div>   </div></fieldset></form>',this.parent=document.body,this.modal=document.getElementById("modal-changes-body"),this.modal.innerHTML=" ",this._createModal()}question(){return this.save_button=document.getElementById("confirm-changes"),new Promise(((e,t)=>{this.save_button.addEventListener("click",(()=>{event.preventDefault(),e(!0),this._destroyModal()}))}))}_createModal(){const e=document.createElement("div");e.classList.add("container"),this.modal.appendChild(e);const t=document.createElement("span");t.innerHTML=this.html,e.appendChild(t),$("#modal-changes").modal("show")}_destroyModal(){$("#modal-changes").modal("hide")}}async function editCollection(){event.preventDefault();let e=new EditModal;await e.question()}function getProductDetail(e){let t=new FormData;return t.append("product_id",e),new Promise((function(e,n){var o=new XMLHttpRequest;o.open("POST","/nexilis/logics/get_product_data"),o.onload=function(){this.status>=200&&this.status<300?e(JSON.parse(o.response)):n({status:this.status,statusText:o.statusText})},o.onerror=function(){n({status:this.status,statusText:o.statusText})},o.send(t)}))}function getPostDetail(e){let t=new FormData;t.append("product_id",e);let n="";return n=window.Android?window.Android.getFPin():new URLSearchParams(window.location.search).get("f_pin"),t.append("f_pin",n),new Promise((function(e,n){var o=new XMLHttpRequest;o.open("POST","/nexilis/logics/get_post_data"),o.onload=function(){this.status>=200&&this.status<300?e(JSON.parse(o.response)):n({status:this.status,statusText:o.statusText})},o.onerror=function(){n({status:this.status,statusText:o.statusText})},o.send(t)}))}function changeTab(e){const t=document.getElementById("description"),n=document.getElementById("ratings"),o=document.getElementById("description-tab"),a=document.getElementById("ratings-tab");"description"==e?(t.classList.remove("d-none"),n.classList.add("d-none"),a.classList.remove("tab-active"),o.classList.add("tab-active")):(n.classList.remove("d-none"),t.classList.add("d-none"),o.classList.remove("tab-active"),a.classList.add("tab-active"))}function playModalVideo(){$("#modal-addtocart .addcart-img-container video").each((function(){$(this).off("play"),$(this).on("play",(function(e){$(this).closest(".carousel").carousel("pause")})),$(this).get(0).play(),$(this).parent().find(".video-play").addClass("d-none")}))}let modalAddToCart=document.getElementById("modal-addtocart");function ext(e){return(e=e.substr(1+e.lastIndexOf("/")).split("?")[0]).split("#")[0].substr(e.lastIndexOf("."))}function goToLink(e){window.Android&&window.Android.setIsProductModalOpen(!1),window.location.href=e}modalAddToCart.addEventListener("show.bs.modal",(function(e){if($("body").hasClass("no-modal"))return!1;window.Android?window.Android.tabShowHide(!1):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.tabShowHide&&window.webkit.messageHandlers.tabShowHide.postMessage({param1:!1})})),modalAddToCart.addEventListener("shown.bs.modal",(function(){$("body").hasClass("no-modal")&&hideAddToCart(),window.Android&&window.Android.setIsProductModalOpen(!0),checkButtonPos(),playModalVideo()})),modalAddToCart.addEventListener("hidden.bs.modal",(function(){$("body").removeClass("no-modal"),window.Android?window.Android.tabShowHide(!0):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.tabShowHide&&window.webkit.messageHandlers.tabShowHide.postMessage({param1:!0}),window.Android&&window.Android.setIsProductModalOpen(!1),$("#modal-addtocart").find("video").length>0&&$("#modal-addtocart .modal-body video").get(0).pause()}));let $image_type_arr=["jpg","jpeg","png","webp"],$video_type_arr=["mp4","mov","wmv","flv","webm","mkv","gif","m4v","avi","mpg"],ext_re=/(?:\.([^.]+))?$/;function decodeURI(e){return decodeURIComponent((e+"").replace(/\+/g,"%20"))}let richText=e=>e.replace(/\*([^\*]+)\*/g,"<strong>$1</strong>").replace(/\^([^\^]+)\^/g,"<u>$1</u>").replace(/\_([^\_]+)\_/g,"<i>$1</i>").replace(/\~([^\~]+)\~/g,"<del>$1</del>").replace(/[\n\r]+/g,"<br>");class Addtocart{constructor(e,t=""){let n=e.THUMB_ID.split("|"),o="";n.forEach(((t,a)=>{var s="",i=ext_re.exec(t)[1];$image_type_arr.includes(i)?s=`<img draggable="false" class="product-img" src="${t.includes("http")?t:"/nexilis/images/"+t}">`:$video_type_arr.includes(i)&&(s=`\n              <div class="video-wrap" id="videowrap-modal-${e.CODE}">\n              <video class="myvid" muted playsinline>\n              <source src="${n.includes("http")?t:"/nexilis/images/"+t}">\n              </video>\n              <div class="video-sound" onclick="event.stopPropagation(); toggleVideoMute('videowrap-modal-${e.CODE}');">\n              <img draggable="false" src="../assets/img/video_mute.png" />\n              </div>\n              <div class="video-play d-none">\n              '<img draggable="false" src="../assets/img/video_play.png" />\n              </div>\n              </div>\n              `),s&&(o=0==a?o+'<div class="carousel-item active">'+s+"</div>":o+'<div class="carousel-item">'+s+"</div>")}));let a="";n.length>1&&(a='\n            <a class="carousel-control-prev" data-bs-target="#carousel-addtocart" data-bs-slide="prev" onclick="event.stopPropagation();"><span class="carousel-control-prev-icon"></span></a>\n            <a class="carousel-control-next" data-bs-target="#carousel-addtocart" data-bs-slide="next" onclick="event.stopPropagation();"><span class="carousel-control-next-icon"></span></a>\n            ');let s=e.LINK,i=o,d="",l="Click here";1==localStorage.lang&&(l="Klik di sini"),null!=s&&""!=s&&("http"!=s.substring(0,4)&&(s="https://"+s),d=`\n            <a class="btn btn-dark" onclick="goToLink('${s}');" style="font-size:12px;">${l}</a>\n            `);let c="";c=null!=e.SHOP_THUMBNAIL&&""!=e.SHOP_THUMBNAIL.trim()?"/filepalio/image/"+e.SHOP_THUMBNAIL:"/nexilis/assets/img/ic_person_boy.png";let r="";r=window.Android?window.Android.getFPin():new URLSearchParams(window.location.search).get("f_pin");let m="",p=richText(decodeURI(e.DESCRIPTION));m=p.includes("klik disini saja")?p.replace("klik disini saja",'<a href="'+s+'" style="text-decoration: underline; color:blue;">klik disini saja</a>'):p;let u="../assets/img/jim_likes.png?v=2";likedPost.length>0&&likedPost.includes(e.CODE)&&(u="../assets/img/jim_likes_red.png");let w="../assets/img/jim_comments.png?v=2";commentedProducts.length>0&&commentedProducts.includes(e.CODE)&&(w="../assets/img/jim_comments_blue.png");let g=`\n        <div class="row">\n            <div class="col-12 d-flex align-items-center justify-content-start">\n                        <div class="d-flex align-items-center">\n                        <div class="like-button" onclick="likeProduct('${e.CODE}', '1')">\n                            <img draggable="false" id="like-${e.CODE}" src="${u}" height="25" width="25">\n                            <div id="like-counter-${e.CODE}" class="like-comment-counter">${e.TOTAL_LIKES}</div>\n                        </div>\n                        <div class="comment-button">\n                            <a onclick="openComment('${e.CODE}',1)">\n                            <img draggable="false" class="comment-icon-${e.CODE}" src="${w}" height="25" width="25">\n                            </a>\n                            <div class="like-comment-counter">${e.TOTAL_COMMENT}</div>\n                        </div>\n                        </div>\n                        </div>\n                    </div>\n        `,h=`\n        <div class="row">\n            <div class="col-10 d-flex align-items-center justify-content-start">\n                <div class="product-name m-0 fw-bold" style="font-size:13px;">${richText(decodeURI(e.PRODUCT_NAME))}</div>\n            </div>\n            <div class="col-2 d-flex align-items-center justify-content-end">\n                <div class="product-name m-0 fw-bold" style="font-size:13px;">\n                    <img draggable="false" class="${e.F_PIN!=r?"":"d-none"}" src="../assets/img/warning.png?v=2" style="width: 25px; height: 25px" id="dropdownMenuSelectLanguage" data-bs-toggle="dropdown" aria-expanded="false"></img>\n                    <ul class="dropdown-menu shadow-lg" style="min-width: auto !important; position: absolute; border: 1px solid black; z-index: 1000" aria-labelledby="dropdownMenuLanguage">\n                    \n                    <li id="report_content" onclick="reportContent('${e.CODE}','${e.REPORT}')"><a class="dropdown-item" data-translate="tab5listing-10">Report/flag Content</a></li>\n                    <li id="report_user" onclick="reportUser('${e.F_PIN}')" ><a class="dropdown-item" data-translate="tab5listing-10">Report/flag User</a></li>\n                    <li id="block_content" class="${"0"===isChangedProfile?"d-none":""}" onclick="blockContent('${e.CODE}')"><button type="submit" style="color:brown" class="dropdown-item">Remove/Block Content</button></li>\n                    <li id="block_user" class="${"0"===isChangedProfile?"d-none":""}" onclick="blockUser('${e.F_PIN}')"><button type="submit" style="color:brown" class="dropdown-item" data-translate="tab5listing-11">Remove/Block User</button></li>\n                  \n                  </ul>\n                </div>\n            </div>\n        </div>\n        `,f=1==e.PRICING,v="";1==e.OFFICIAL_ACCOUNT||3==e.OFFICIAL_ACCOUNT?v='<img draggable="false" src="/nexilis/assets/img/ic_official_flag.webp" style="width:15px; height:15px;"/>':2==e.OFFICIAL_ACCOUNT&&(v='<img draggable="false" src="/nexilis/assets/img/ic_verified_flag.png" style="width:15px; height:15px;"/>'),this.html=`<div class="container-fluid">\n                <div class="col-12 px-0 mb-3">\n                    <div class="addcart-img-container text-center">\n                        <div id="carousel-addtocart" class="carousel slide" data-bs-ride="carousel" data-bs-interval="false">\n                            <div class="carousel-inner">\n                                ${i}\n                                ${a}\n                            </div>\n                        </div>\n                        <img draggable="false" class="addcart-wishlist logo" src="${c}">\n                        <span class="d-flex align-items-center addcart-wishlist name small-text">${v}&emsp;${e.SHOP_NAME}</span>\n                        <img draggable="false" class="addcart-wishlist star d-none" src="../assets/img/icons/wishlist-yellow.png" style="right:15px;">\n                        <img draggable="false" class="addcart-wishlist more d-none" src="../assets/img/icons/More-white.png">\n                    </div>\n                </div>\n            </div>\n\n            <div class="container content-section">\n                <div class="container">\n                    <div class="row px-3">\n                        \n                        <div class="col-12">\n                        ${window.location.href.includes("tab3-main")?h+g:h}\n                        </div>\n                        <div class="col-3 d-none d-flex align-items-center justify-content-end">\n                            <img draggable="false" class="mx-1" src="../assets/img/icons/wishlist-yellow.png" width="20px"><div class="fs-6 fw-bold product-name">5.0</div>\n                        </div>\n                    </div>\n                    <div class="row px-3 ${f?"":"d-none"}">\n                        <div class="col-8 d-flex align-items-center justify-content-start">\n                            <h5 class="product-price fs-6 m-0">Rp ${e.PRICE.toLocaleString("en-US")}</h5>\n                        </div>\n                        <div class="col-4 d-flex align-items-center justify-content-end">\n                            <h5 class="product-price small-text">1,1RB Terjual</h5>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="container-fluid d-none mt-2 bg-white small-text fw-bold" style="color: #bbb">\n                    <div class="row">\n                        <div onclick="changeTab('description');" id="description-tab" class="col-6 p-2 text-center font-medium tab-active">\n                            Description\n                        </div>\n                        <div onclick="changeTab('ratings');" id="ratings-tab" class="col-6 p-2 text-center font-medium">\n                            Ratings\n                        </div>\n                    </div>\n                </div>\n\n                <div class="container">\n                    <div id="description" class="m-3 prod-details">\n                        <div class="col-12 small-text">\n                        ${""!=d?d+"<br><br>":""}                    \n                        ${m}\n                        </div>\n                    </div>\n\n                    <div id="ratings" class="d-none m-3 ratings d-none d-flex align-items-center">\n                        <div class="col-12">\n                            <div class="row my-4">\n                                <ul class="list-group list-group-horizontal d-flex align-items-center justify-content-evenly">\n                                    <li class="list-group-item">100+ Friendly Seller</li>\n                                    <li class="list-group-item">100+ Quick Response</li>\n                                    <li class="list-group-item">100+ Quick Delivery</li>\n                                    <li class="list-group-item">100+ Great Packaging</li>\n                                </ul>\n                            </div>\n                            <div class="row">\n                                <div class="col">\n                                    All reviews\n                                    <div class="overflow-auto"></div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="container" id="comments-modal" style="margin-bottom: 5rem"> \n                ${t}\n                </div>\n                \n                <div class="col prod-addtocart ${f?"":"d-none"}">\n                    <div class="container py-1">\n                        <div class="row">\n                            <div class="col-3">\n                                <div class="input-group counter">\n                                    <button class="btn btn-outline-secondary btn-decrease" type="button" onclick="changeItemQuantity('modal-item-qty','sub')">-</button>\n                                    <input id="modal-item-qty" type="text" pattern="d*" maxlength="3" class="form-control text-center" placeholder="" value="1" min="1">\n                                    <button class="btn btn-outline-secondary btn-increase" type="button" onclick="changeItemQuantity('modal-item-qty','add')">+</button>\n                                </div>\n                            </div>\n                            <div class="col-9">\n                                <button id="add-to-cart" class="btn btn-addcart w-100" onclick="addToCartPost('${e.CODE}');">Add to Cart</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            `,this.parent=document.body,this.modal=document.getElementById("modal-add-body"),this.modal.innerHTML=" ",this._createModal(),playVid()}static async build(e){let t=await getProductDetail(e),n="";return"1"==isChangedProfile&&(n=await getComments(e)),new Addtocart(t,n)}static async buildPost(e){let t=await getPostDetail(e),n="";return n=await getComments(e),new Addtocart(t,n)}question(){return this.save_button=document.getElementById("confirm-changes"),new Promise(((e,t)=>{this.save_button.addEventListener("click",(()=>{event.preventDefault(),e(!0),this._destroyModal()}))}))}_createModal(e){this.modal.innerHTML=this.html,$("#modal-addtocart").modal("show"),window.Android&&window.Android.setIsProductModalOpen(!0),window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.setIsProductModalOpen&&window.webkit.messageHandlers.setIsProductModalOpen.postMessage({param1:!0})}_destroyModal(){$("#modal-addtocart").modal("hide")}}function getComments(e){return new Promise((function(t,n){let o=window.Android?window.Android.getFPin():new URLSearchParams(window.location.search).get("f_pin"),a="comment_modal.php?product_code="+e+"&f_pin="+o+"&is_post=1&icp="+isChangedProfile+"&lang="+localStorage.lang;xReply=1,xReffReply=10;$.get(a,(function(e){t(e)}))}))}function hideAddToCart(){$("#modal-addtocart").hasClass("show")?($(".modal.in").modal("hide"),$("#modal-addtocart").modal("hide")):$("#modal-product").hasClass("show")&&$("#modal-product").modal("hide"),window.Android&&window.Android.setIsProductModalOpen(!1),window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.setIsProductModalOpen&&window.webkit.messageHandlers.setIsProductModalOpen.postMessage({param1:!1})}async function showAddModal(e){event.preventDefault();await Addtocart.build(e)}async function showAddModalPost(e){event.preventDefault();await Addtocart.buildPost(e)}function changeItemQuantity(e,t){"add"==t?document.getElementById(e).value=parseInt(document.getElementById(e).value)+1:document.getElementById(e).value>1&&(document.getElementById(e).value=parseInt(document.getElementById(e).value)-1)}function addToCartPost(e){event.preventDefault();let t=document.getElementById("modal-item-qty").value,n=new FormData;if(n.append("product_id",e),0==t)alert("Please set the quantity!");else{let e=new XMLHttpRequest;e.open("POST","/nexilis/logics/get_post_data"),e.send(n),e.onload=async function(){if(200!=e.status)alert(`Error ${e.status}: ${e.statusText}`);else{let n=JSON.parse(e.response);savePostToLocalStorage(n,t),$("#modal-addtocart").length>0&&$("#modal-addtocart").modal("hide"),$("#addtocart-success").length>0&&$("#addtocart-success").modal("show")}}}}function reportContent(e,t,n=!1){if(window.Android){if(!window.Android.checkProfile())return}else if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.checkProfile&&!1===n)return void window.webkit.messageHandlers.checkProfile.postMessage({param1:e+"|"+t,param2:"report_content"});$("#modal-product").length>0&&$("#modal-product").hasClass("show")&&$("#modal-product").modal("hide"),$("#modal-category").modal("show"),localStorage.setItem("report_post_id",e),localStorage.setItem("report_count",t)}function reportContentSubmit(){var e=e=window.Android?window.Android.getFPin():new URLSearchParams(window.location.search).get("f_pin"),t=localStorage.getItem("report_post_id"),n=$('input[name="report_category"]:checked').val(),o=localStorage.getItem("report_count"),a=new FormData;a.append("f_pin",e),a.append("post_id",t),a.append("report_category",n),a.append("count_report",o);let s=new XMLHttpRequest;s.onreadystatechange=function(){4==s.readyState&&200==s.status&&("Berhasil"==s.responseText?($("#modal-category").modal("hide"),$("#modal-product").length>0&&$("#modal-product").hasClass("show")&&$("#modal-product").modal("hide"),$("#modal-report-success").modal("show")):alert("Report Content Gagal"))},s.open("post","../logics/report_content"),s.send(a)}function reportUser(e,t=!1){if(window.Android){if(!window.Android.checkProfile())return;$("#modal-category2").modal("show"),localStorage.setItem("f_pin_reported",e)}window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.checkProfile&&!1===t?window.webkit.messageHandlers.checkProfile.postMessage({param1:e,param2:"report_user"}):($("#modal-product").length>0&&$("#modal-product").hasClass("show")&&$("#modal-product").modal("hide"),$("#modal-category2").modal("show"),localStorage.setItem("f_pin_reported",e))}function reportUserSubmit(){t=window.Android?window.Android.getFPin():new URLSearchParams(window.location.search).get("f_pin");var e=new FormData,t=t,n=localStorage.getItem("f_pin_reported"),o=$('input[name="report_category"]:checked').val();e.append("f_pin",t),e.append("f_pin_reported",n),e.append("report_category",o),e.append("count_report",2);let a=new XMLHttpRequest;a.onreadystatechange=function(){4==a.readyState&&200==a.status&&("Berhasil"==a.responseText?($("#modal-category2").modal("hide"),$("#modal-report-success").modal("show")):alert("Report User Gagal"))},a.open("post","../logics/report_user"),a.send(e)}function blockUser(e,t=!1){if(window.Android){if(!window.Android.checkProfile())return;o=window.Android.getFPin()}else{if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.checkProfile&&!1===t)return void window.webkit.messageHandlers.checkProfile.postMessage({param1:e,param2:"block_user"});o=new URLSearchParams(window.location.search).get("f_pin")}var n=new FormData,o=o;e=e;$("#modal-product").length>0&&$("#modal-product").hasClass("show")&&$("#modal-product").modal("hide"),n.append("f_pin",o),n.append("l_pin",e);let a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&200==a.status)if("Berhasil"==a.responseText){if($("#modal-addtocart").modal("hide"),$("#modal-block-success").modal("show"),window.Android)window.Android.blockContact(e);else if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.blockContact)return void window.webkit.messageHandlers.blockContact.postMessage({param1:e})}else alert("Block User Gagal")},a.open("post","../logics/block_user"),a.send(n)}function unblockUser(e){n=window.Android?window.Android.getFPin():new URLSearchParams(window.location.search).get("f_pin");var t=new FormData,n=n;e=e;t.append("f_pin",n),t.append("l_pin",e);let o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==o.readyState&&200==o.status)if("Berhasil"==o.responseText){if($("#modal-addtocart").modal("hide"),0==localStorage.lang?($("#modal-block-success .modal-body>p").text("You unblocked this user."),$("#close-blocked").text("Close")):($("#modal-block-success .modal-body>p").text("Anda telah membuka blokir user ini."),$("#close-blocked").text("Tutup")),$("#modal-block-success").modal("show"),window.Android)window.Android.blockUser(e,!1);else if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.blockUser)return void window.webkit.messageHandlers.blockUser.postMessage({param1:e,param2:!1})}else alert("Block User Failed")},o.open("post","../logics/unblock_user"),o.send(t)}function blockContent(e,t=!1){var n="";if(window.Android){if(!window.Android.checkProfile())return;n=window.Android.getFPin()}else{if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.checkProfile&&!1===t)return void window.webkit.messageHandlers.checkProfile.postMessage({param1:e,param2:"block_content"});n=new URLSearchParams(window.location.search).get("f_pin")}var o=new FormData,a=(n=n,e),s=new Date;now=s.getTime(),$("#modal-product").length>0&&$("#modal-product").hasClass("show")&&$("#modal-product").modal("hide"),o.append("f_pin",n),o.append("post_id",a),o.append("time",now);let i=new XMLHttpRequest;i.onreadystatechange=function(){4==i.readyState&&200==i.status&&("Success"==i.responseText?($("#modal-addtocart").modal("hide"),$("#modal-block-content-success").modal("show")):alert("Block Post Gagal"))},i.open("post","../logics/block_post"),i.send(o)}function reloadPages(){$("#modal-report-success").modal("hide"),$("#modal-addtocart").modal("hide")}function reloadPagesBlock(){location.reload()}function showAlert(e){window.Android&&window.Android.showAlert(e),window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.showAlert&&window.webkit.messageHandlers.showAlert.postMessage({param1:e})}function commentProduct(e){if(""==document.getElementById("input").value.trim()){let e="Write a comment...";return 1==localStorage.lang&&(e="Isi komentar..."),void showAlert(e)}$("input:text").click((function(){$(this).val("")}));var t="";if(""!=(t=window.Android?window.Android.getFPin():new URLSearchParams(window.location.search).get("f_pin"))){var n=(new Date).getTime(),o=new FormData,a=n.toString()+t;o.append("product_code",e),o.append("f_pin",t),o.append("last_update",n),o.append("comment",document.getElementById("input").value.trim()),o.append("discussion_id",a),xReply++;new URLSearchParams(window.location.search).get("is_post");if(o.append("is_post",1),!document.getElementById("reply-div").classList.contains("d-none")){var s=getCookie("commentId");o.append("reply_id",s),xReffReply+=10}let i=new XMLHttpRequest;i.onreadystatechange=function(){4==i.readyState&&200==i.status&&"Success Comment"==i.responseText&&(document.getElementById("reply-div").classList.contains("d-none")||(deleteAllCookies(),$("#reply-div").addClass("d-none"),document.getElementById("content-comment").style.marginBottom="3.5rem"),$("input#input").val(""),appendComment(o),updateScore(e,"comment"))},i.open("post","/nexilis/logics/comment_product"),i.send(o)}}function getCookie(e){return document.cookie.length>0&&(c_start=document.cookie.indexOf(e+"="),-1!=c_start)?(c_start=c_start+e.length+1,c_end=document.cookie.indexOf(";",c_start),-1==c_end&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):""}async function appendComment(e){let t={};e.forEach(((e,n)=>t[n]=e));let n=new Date(parseInt(t.last_update)),o=n.getHours()+":"+n.getMinutes(),a=t.f_pin+t.last_update,s=await getProfpic(t.f_pin),i=await getUserName(t.f_pin),d="Reply",l="Delete";0==localStorage.lang?(d="Reply",l="Delete"):1==localStorage.lang&&(d="Balas",l="Hapus");let c=window.Android?window.Android.getFPin():new URLSearchParams(window.location.search).get("f_pin");if(t.hasOwnProperty("reply_id")){let e=t.reply_id,n=`\n        <div class="row comments cmt-reply" id="${a}" style="width:100%;">\n        <div class="commentId" style="display: none;">${a}</div>\n        <div class="fPin" style="display: none;">${t.f_pin}</div>\n        <div class="col-2">\n          <img draggable="false" onclick="window.location.href='tab3-profile?f_pin=${c}&store_id=${t.f_pin}'" id="user-thumb-reff-new-${xReffReply}" class="rounded-circle my-2" style="height:40px; width:40px; cursor:pointer; object-position: center; background: grey; object-fit: cover;" src="${s}">\n        </div>\n        <div class="col-10 text-break">\n          <div style="font-weight: bold;" class="mt-2 mb-1 mr-3">\n            <span id="user-name-reff-new-${xReffReply}">${i} </span>\n            <span style="font-weight: 300;"> ${t.comment}</span>\n          </div>\n          <div style="font-weight: 100; color: grey;" class="my-1">${o}&emsp; <span data-translate="comment-2" style="font-weight: 300;" onclick="onReply(true,'user-name-reff-new-${xReffReply}','${a}');">${d}</span>&emsp;<span class="text-delete" style="font-weight: 300;" onclick="showSuccessModal('${a}');">${l}</span>\n          </div>\n        </div>\n      </div>\n        `;!$(".comments#"+e).hasClass("cmt-reply")?$(".comments#"+e).append(n):$(".comments#"+e).after(n)}else{let e=document.getElementById("content-comment"),n=`\n        <div class="row mx-0 comments" id="${a}">\n            <div class="commentId" style="display: none;">${a}</div>\n            <div class="fPin" style="display: none;">${t.f_pin}</div>\n            <div class="col-2">\n            <img draggable="false" onclick="window.location.href='tab3-profile?f_pin=${c}&store_id=${t.f_pin}'" id="user-thumb-new-${xReply}" class="rounded-circle my-2" style="height:40px; width:40px; cursor:pointer; object-position: center; background: grey; object-fit: cover;" src="${s}">\n            </div>\n            <div class="col-10 text-break">\n            <div style="font-weight: bold;" class="mt-2 mb-1 mr-3">\n                <span id="user-name-new-${xReply}">${i} </span>\n                <span style="font-weight: 300;"> ${t.comment}</span>\n            </div>\n            <div style="font-weight: 100; color: grey;" class="my-1">${o}&emsp; <span style="font-weight: 300;" data-translate="comment-2" onclick="onReply(true,'user-name-new-${xReply}','${a}');">${d}</span>&emsp;<span class="text-delete" style="font-weight: 300;" onclick="showSuccessModal('${a}');">${l}</span>\n            </div>\n            </div>\n        </div>\n        `;e.innerHTML+=n}enableDelete()}function openDelete(e){return function(t){t.preventDefault(),t.stopPropagation(),showSuccessModal(e,void 0)}}function enableDelete(){$(".first-comment").each((function(){if(!$(this).hasClass("is-deleted")){let t=$(this).siblings(".commentId").text(),n=$(this).siblings(".fPin").text();var e="";try{e=new URLSearchParams(window.location.search).get("f_pin")}catch(e){}if(n!=e)return;$(this).unbind("contextmenu"),$(this).contextmenu((function(e){e.preventDefault(),e.stopPropagation(),showSuccessModal(t,void 0)}))}})),$(".comments").each((function(){let e=$(this).find(".commentId").text(),t=$(this).find(".fPin").text();var n="";try{n=new URLSearchParams(window.location.search).get("f_pin")}catch(e){}t==n&&($(this).unbind("contextmenu"),$(this).contextmenu((function(t){t.preventDefault(),t.stopPropagation(),showSuccessModal(e,void 0)})))}))}async function showSuccessModal(e,t){event.preventDefault(),$("body").css("overflow","hidden"),this.myModal=new SuccessModal(e,t);try{"delete"==await myModal.question()&&(this.myModal._destroyModal(),$(".comments#"+e).addClass("is-deleted"))}catch(e){}}$(document).on("click",".dropdown-menu",(function(e){e.stopPropagation()})),enableDelete();class SuccessModal{constructor(e,t){0==localStorage.lang?(this.modalTitle="Are you sure you want to delete this comment?",this.acceptText="Delete",this.cancelText="Cancel"):(this.modalTitle="Yakin ingin menghapus komentar ini?",this.acceptText="Hapus",this.cancelText="Batal"),this.parent=document.body,this.commentId=e,this.method=t,this.modal=void 0,this.acceptButton=void 0,this.cancelButton=void 0,this._createModal()}question(){return new Promise(((e,t)=>{this.modal&&this.acceptButton?(this.acceptButton.addEventListener("click",(()=>{var t=new FormData;t.append("comment_id",this.commentId);let n=new URLSearchParams(window.location.search).get("is_post");t.append("is_post",n);let o=new XMLHttpRequest;o.onreadystatechange=function(){4==o.readyState&&200==o.status&&"Success Delete Comment"==o.responseText&&e("delete")},o.open("post","/nexilis/logics/delete_comment"),o.send(t)})),this.cancelButton.addEventListener("click",(()=>{this._destroyModal(),e("destroy"),$("body").css("overflow","auto")}))):t("There was a problem creating the modal window!")}))}_createModal(){this.modal=document.createElement("dialog"),this.modal.setAttribute("style","z-index: 1100;"),this.modal.classList.add("simple-modal-dialog"),this.modal.show();const e=document.createElement("div");e.classList.add("simple-modal-window"),this.modal.appendChild(e);const t=document.createElement("div");t.classList.add("simple-modal-title"),e.appendChild(t);const n=document.createElement("span");n.classList.add("simple-modal-title-text"),n.style.marginLeft="5px",n.style.marginRight="5px",n.textContent=this.modalTitle,t.appendChild(n);const o=document.createElement("div");o.classList.add("simple-modal-button-group"),e.appendChild(o),this.acceptButton=document.createElement("button"),this.acceptButton.type="button",this.acceptButton.classList.add("simple-modal-button-green"),this.acceptButton.textContent=this.acceptText,o.appendChild(this.acceptButton),this.cancelButton=document.createElement("button"),this.cancelButton.type="button",this.cancelButton.classList.add("simple-modal-button-red"),this.cancelButton.textContent=this.cancelText,o.appendChild(this.cancelButton),this.parent.appendChild(this.modal)}_destroyModal(){this.parent.removeChild(this.modal)}}function onReply(e,t,n){if(e){$("#input").focus(),finalName=document.getElementById(t).innerHTML,0==localStorage.lang?document.getElementById("content-reply").innerHTML="Reply to "+finalName:1==localStorage.lang&&(document.getElementById("content-reply").innerHTML="Balas ke "+finalName),document.getElementById("content-comment").style.marginBottom="3.5rem",document.cookie="commentId="+n,$("#reply-div").removeClass("d-none")}else deleteAllCookies(),$("#reply-div").addClass("d-none"),document.getElementById("content-comment").style.marginBottom="3.5rem"}function deleteAllCookies(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){var n=e[t],o=n.indexOf("="),a=o>-1?n.substr(0,o):n;document.cookie=a+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}}function getDisplayName(e,t){let n=e;try{window.Android&&(n=window.Android.getDisplayName(e))}catch(e){}if(n==e){var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){var e=JSON.parse(o.responseText);if(e.length>0){var n=e[0],a=n.FIRST_NAME,s=n.LAST_NAME,i="";i=s?a+" "+s:a,document.getElementById("user-name-"+t).innerHTML=i}}},o.open("get","/nexilis/logics/fetch_person?f_pin="+e),o.send()}else document.getElementById("user-name-"+t).innerHTML=n}function getUserName(e){let t=e;return new Promise((function(n,o){try{window.Android&&(t=window.Android.getDisplayName(e))}catch(e){}if(t==e){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var e=JSON.parse(a.responseText);if(e.length>0){var o=e[0],s=o.FIRST_NAME,i=o.LAST_NAME;t=i?s+" "+i:s,n(t)}}},a.open("get","/nexilis/logics/fetch_person?f_pin="+e),a.send()}else n(t)}))}function getDisplayNameReff(e,t,n){let o=e;try{window.Android&&(o=window.Android.getDisplayName(e))}catch(e){}if(o==e){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var e=JSON.parse(a.responseText);if(e.length>0){var o=e[0],s=o.FIRST_NAME,i=o.LAST_NAME,d="";d=i?s+" "+i:s,document.getElementById("user-name-reff-"+t+n).innerHTML=d}}},a.open("get","/nexilis/logics/fetch_person?f_pin="+e),a.send()}else document.getElementById("user-name-reff-"+t+n).innerHTML=o}function getThumbId(e,t){let n="";try{window.Android&&(n=window.Android.getImagePerson(e))}catch(e){}try{if(""==n){n="../assets/img/ic_person_boy.png",document.getElementById("user-thumb-"+t).src=n;var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){var e=JSON.parse(o.responseText);if(e.length>0){var a=e[0];a.IMAGE&&(n="/filepalio/image/"+a.IMAGE),document.getElementById("user-thumb-"+t).src=n}}},o.open("get","/nexilis/logics/fetch_person?f_pin="+e),o.send()}else n="/filepalio/image/"+n,document.getElementById("user-thumb-"+t).src=n}catch(e){}}function getThumbIdReff(e,t,n){let o="";try{window.Android&&(o=window.Android.getImagePerson(e))}catch(e){}try{if(""==o){o="../assets/img/ic_person_boy.png",document.getElementById("user-thumb-reff-"+t+n).src=o;var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var e=JSON.parse(a.responseText);if(e.length>0){var s=e[0];s.IMAGE&&(o="/filepalio/image/"+s.IMAGE),document.getElementById("user-thumb-reff-"+t+n).src=o}}},a.open("get","/nexilis/logics/fetch_person?f_pin="+e),a.send()}else o="/filepalio/image/"+o,document.getElementById("user-thumb-reff-"+t+n).src=o}catch(e){}}function getProfpic(e){let t="";return new Promise((function(n,o){try{window.Android&&(t=window.Android.getImagePerson(e))}catch(e){}if(""==t){t="../assets/img/ic_person_boy.png";var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var e=JSON.parse(a.responseText);if(e.length>0){var o=e[0];o.IMAGE&&(t="/filepalio/image/"+o.IMAGE),n(t)}}},a.open("get","/nexilis/logics/fetch_person?f_pin="+e),a.send()}else t="/filepalio/image/"+t,n(t)}))}function onFocusInput(){if(window.Android)try{window.Android.onFocusInput()}catch(e){}}